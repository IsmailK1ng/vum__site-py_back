{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">

  <!-- Заголовок страницы -->
  <title>Faw Trucks в Узбекистане</title>

  <!-- Мета теги -->
  <meta name="description" content="Faw Trucks в Узбекистане">
  <meta name="keywords" content="Faw Trucks в Узбекистане">
  <meta name="author" content="mix_design">

  <!-- Мета viewport -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Фавикон и иконки (начало) -->
  <link rel="shortcut icon" href="{% static 'images/icon/favicon_5.ico' %}" type="image/x-icon" />
  <link rel="apple-touch-icon" href="{% static 'images/icon/_iiiiapple.png' %}" />
  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'images/icon/_iiii176.png' %}" />
  <link rel="apple-touch-icon" sizes="152x152" href="{% static 'images/icon/_iiii1156.png' %}" />
  <link rel="apple-touch-startup-image" href="{% static 'images/icon/_iiii1.png' %}" />
  <!-- Фавикон и иконки (конец) -->

  <!-- Мета для Facebook (начало) -->
  <meta property="og:image:height" content="1200">
  <meta property="og:image:width" content="1200">
  <meta property="og:title" content="Faw Trucks в Узбекистане">
  <meta property="og:description" content="Faw Trucks в Узбекистане">
  <meta property="og:url" content="https://mixdesign.dev/themeforest/rayo">
  <meta property="og:image" content="https://mixdesign.dev/themeforest/rayo/img/og-image.jpg">
  <!-- Мета для Facebook (конец) -->

  <!-- Подключение стилей (начало) -->
  <link rel="stylesheet" type="text/css" href="{% static 'css/loaders/loader.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/plugins.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/main_site.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/site_main.css' %}">
  <link rel="stylesheet" type="text/css" href="{% static 'css/faw_main-models.css' %}">
  <!-- Стили Leaflet для карты в футере -->


  <!-- Цвет браузера (начало) -->
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#FAF7F6">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#161616">
  <meta name="msapplication-navbutton-color" content="#161616">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Цвет браузера (конец) -->
  <style>
    /* Loader */
    .loader-container {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 400px;
      width: 100%;
    }

    .loader {
      font-size: 18px;
      color: #666;
    }

    .error-message,
    .no-results {
      text-align: center;
      padding: 40px;
      color: #999;
      font-size: 18px;
    }
  </style>
</head>

<body>

  <!-- Меню и шапка (начало) -->
  {% include 'main/includes/header.html' %}
  <!-- Меню и шапка (конец) -->


  <!-- Контент страницы (начало) -->
  <main id="mxd-page-content" class="mxd-page-content">

    <!-- Секция героя (начало) -->
    <div class="mxd-section">
      <div class="mxd-hero-06">
        <div class="mxd-hero-06__wrap loading-wrap">
          <div class="mxd-hero-06__top">
            <div class="mxd-hero-06__content">
              <div class="mxd-hero-06__data">
                <div class="mxd-hero-06__headline">
                  <div class="hero-06-headline__descr">
                    <div class="row g-0">
                      <div class="col-12 col-xl-12 mxd-grid-item no-margin">
                        <div class="mxd-section-models__title">
                          <h2 class="models_title">{{ category_info.title }}</h2>
                        </div>
                      </div>
                      <div class="col-12 col-xl-8 mxd-grid-item no-margin">
                        <div class="mxd-section-title__hrdescr">
                          <span class="hero-05-title__row loading__item">
                            <em class="hero-05-title__item title-item-image">
                              <svg class="mxd-pulse" xmlns="http://www.w3.org/2000/svg" version="1.1"
                                viewBox="0 0 20 20">
                                <path
                                  d="M19.6,9.6h-3.9c-.4,0-1.8-.2-1.8-.2-.6,0-1.1-.2-1.6-.6-.5-.3-.9-.8-1.2-1.2-.3-.4-.4-.9-.5-1.4,0,0,0-1.1-.2-1.5V.4c0-.2-.2-.4-.4-.4s-.4.2-.4.4v4.4c0,.4-.2,1.5-.2,1.5,0,.5-.2,1-.5,1.4-.3.5-.7.9-1.2,1.2s-1,.5-1.6.6c0,0-1.2,0-1.7.2H.4c-.2,0-.4.2-.4.4s.2.4.4.4h4.1c.4,0,1.7.2,1.7.2.6,0,1.1.2,1.6.6.4.3.8.7,1.1,1.1.3.5.5,1,.6,1.6,0,0,0,1.3.2,1.7v4.1c0,.2.2.4.4.4s.4-.2.4-.4v-4.1c0-.4.2-1.7.2-1.7,0-.6.2-1.1.6-1.6.3-.4.7-.8,1.1-1.1.5-.3,1-.5,1.6-.6,0,0,1.3,0,1.8-.2h3.9c.2,0,.4-.2.4-.4s-.2-.4-.4-.4h0Z" />
                              </svg>
                            </em>
                            <em class="hero-05-title__item" style="font-size: 24px; max-width: 400px;">
                              {{ category_info.slogan }}
                            </em>
                          </span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mxd-hero-06__img">
                <img src="{% static category_info.hero_image %}" alt="{{ category_info.title }}">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Секция героя (конец) -->

    <!-- Секция — превью блога (начало) -->
    <div class="mxd-section padding-blog">
      <div class="grid-container">

        <!-- Блок — заголовок секции (начало) -->
        <div class="mxd-block">
          <div class="mxd-section-filter pre-grid">
            <div class="mxd-section-filter__inner animate-card-3">
              <div class="mxd-grid-item">
                <div class="section-filter">
                  <!-- Хлебные крошки -->
                  <div aria-label="breadcrumb">
                    <ol class="breadcrumb-ol">
                      <li><a href="{% url 'home' %}">Bosh sahifa</a></li>
                      <li><a href="javascript:void(0)">Modellar</a></li>
                      <li class="active"><a href="javascript:void(0)">{{ category_info.breadcrumb }}</a></li>
                    </ol>
                  </div>
                  <div class="filter-container">
                    <div class="filter-search">
                      <input type="text" class="filter-search__input" placeholder="Поиск...">
                      <button class="filter-search__btn" aria-label="Search">
                        <img src="{% static 'images/icons/sistem-icons/search.svg' %}" alt="Search">
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Блок — заголовок секции (конец) -->

        <!-- Блок — карточки превью (начало) -->
        <div class="mxd-block">
          <div class="mxd-blog-preview">
            <div class="container-fluid p-0">
              <div class="row g-0 card_block">
                <div class="col-12 col-xl-4 mxd-grid-item animate-card-3 faw-truck-card-container">
                  <!-- Loader -->
                  <div class="loader-container">
                    <div class="loader">Yuklanmoqda...</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Блок — карточки превью (конец) -->
      </div>
      <!-- Пагинация -->
      <div class="mxd-blog-pagination">
        <div class="mxd-blog-pagination__inner">
          <nav class="mxd-blog-pagination__items" id="pagination">
            <!-- Кнопки пагинации будут добавлены через JavaScript -->
          </nav>
        </div>
      </div>
      <!-- Секция — превью блога (конец) -->
    </div>
  </main>
  <!-- Контент страницы (конец) -->

  <!-- Футер (начало) -->
  {% include 'main/includes/footer.html' %}
  <!-- Футер (конец) -->

  <!-- Кнопка «вверх» (начало) -->
  <a href="#0" id="to-top" class="btn btn-to-top slide-up anim-no-delay">
    <i class="ph ph-arrow-up"></i>
  </a>
  <!-- Кнопка «вверх» (конец) -->

  <!-- Подключение скриптов (начало) -->
  <script src="{% static 'js/libs.min.js' %}"></script>
  <script src="{% static 'js/app.js' %}"></script>
  <!-- Счётчики FAW (инициализация) -->
  <script src="{% static 'js/faw.js' %}"></script>
  <script src="{% static 'js/production.js' %}"></script>
  <script>
    // Универсальный плавный скролл, сразу учитывающий высоту фиксированного хедера
    (function () {
      function getHeaderHeight() {
        try { var h = document.getElementById('header'); return h ? h.offsetHeight || 0 : 0; } catch (e) { return 0; }
      }

      function scrollToElementById(id) {
        var el = document.getElementById(id);
        if (!el) return;
        var headerH = getHeaderHeight();
        var offset = 25; // отступ под хедером
        var rect = el.getBoundingClientRect();
        var targetY = Math.max(0, Math.round(window.pageYOffset + rect.top - headerH - offset));
        try { window.scrollTo({ top: targetY, behavior: 'smooth' }); }
        catch (e) { window.scrollTo(0, targetY); }
      }

      // Делегирование: клики по ссылкам вида href="#id"
      document.addEventListener('click', function (e) {
        var a = e.target.closest && e.target.closest('a[href^="#"]');
        if (!a) return;
        var href = a.getAttribute('href');
        if (!href || href === '#') return;
        var id = href.slice(1);
        if (!id) return;
        if (document.getElementById(id)) {
          e.preventDefault();
          scrollToElementById(id);
        }
      }, false);
    })();

    document.addEventListener('DOMContentLoaded', function () {
      // Объявляем переменные только для поиска по grid-карточкам
      const searchInput = document.querySelector('.filter-search__input');

      // Поиск только по grid карточкам
      if (searchInput) {
        searchInput.addEventListener('input', function () {
          const val = searchInput.value.trim().toLowerCase();
          document.querySelectorAll('.faw-truck-card').forEach(card => {
            const title = card.querySelector('.truck-title');
            const text = title ? title.textContent.toLowerCase() : card.textContent.toLowerCase();
            card.style.display = text.includes(val) ? '' : 'none';
          });
        });
      }
    });
    document.addEventListener('DOMContentLoaded', () => {
      const cardGrid = document.querySelector('.faw-truck-card-container');
      const pagination = document.getElementById('pagination');
      const cards = Array.from(cardGrid.getElementsByClassName('faw-truck-card'));
      const cardsPerPage = 6;
      const totalPages = Math.ceil(cards.length / cardsPerPage);
      let currentPage = 1;

      function showPage(page) {
        cards.forEach((card, index) => {
          card.style.display = (index >= (page - 1) * cardsPerPage && index < page * cardsPerPage) ? '' : 'none';
        });
        const pageLinks = pagination.getElementsByClassName('blog-pagination-number');
        Array.from(pageLinks).forEach((link) => {
          link.classList.toggle('active', parseInt(link.dataset.page) === page);
        });
        const prevButton = pagination.querySelector('.prev');
        const nextButton = pagination.querySelector('.next');
        prevButton.classList.toggle('disabled', page === 1);
        nextButton.classList.toggle('disabled', page === totalPages);
        // Исправление бага с футером: форсируем пересчёт layout
        setTimeout(function () { window.dispatchEvent(new Event('resize')); }, 0);
      }

      function createPagination() {
        pagination.innerHTML = '';
        const prevButton = document.createElement('a');
        prevButton.href = 'javascript:void(0);';
        prevButton.className = 'mxd-blog-pagination__item blog-pagination-control prev btn btn-anim btn-line-small btn-bright anim-no-delay slide-left';
        prevButton.innerHTML = `<i class="ph ph-arrow-left"></i><span class="btn-caption">Ortga</span>`;
        prevButton.dataset.page = 'prev';
        prevButton.setAttribute('role', 'button');
        prevButton.setAttribute('aria-label', 'Previous page');
        prevButton.addEventListener('click', (e) => {
          e.preventDefault();
          if (currentPage > 1) {
            currentPage--;
            showPage(currentPage);
          }
        });
        pagination.appendChild(prevButton);

        for (let i = 1; i <= totalPages; i++) {
          const pageLink = document.createElement('a');
          pageLink.href = 'javascript:void(0);';
          pageLink.className = `mxd-blog-pagination__item blog-pagination-number btn btn-anim ${i === 1 ? 'active' : ''}`;
          pageLink.dataset.page = i;
          pageLink.innerHTML = `<span class="btn-caption">${i}</span>`;
          pageLink.setAttribute('role', 'button');
          pageLink.setAttribute('aria-label', `Page ${i}`);
          pageLink.addEventListener('click', (e) => {
            e.preventDefault();
            currentPage = parseInt(pageLink.dataset.page);
            showPage(currentPage);
          });
          pagination.appendChild(pageLink);
        }

        const nextButton = document.createElement('a');
        nextButton.href = 'javascript:void(0);';
        nextButton.className = 'mxd-blog-pagination__item blog-pagination-control next btn btn-anim btn-line-small btn-bright anim-no-delay slide-right';
        nextButton.innerHTML = `<span class="btn-caption">Oldinga</span><i class="ph ph-arrow-right"></i>`;
        nextButton.dataset.page = 'next';
        nextButton.setAttribute('role', 'button');
        nextButton.setAttribute('aria-label', 'Next page');
        nextButton.addEventListener('click', (e) => {
          e.preventDefault();
          if (currentPage < totalPages) {
            currentPage++;
            showPage(currentPage);
          }
        });
        pagination.appendChild(nextButton);

        showPage(currentPage);
      }

      if (cards.length > 0) {
        createPagination();
      }
    });
  </script>

  <!-- Load Scripts End -->

</body>

</html>