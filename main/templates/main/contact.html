{% load static %}
<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8" />

    <!-- Page Title -->
    <title>VUM Kontaktlar</title>

    <!-- Meta Tags -->
    <meta name="description" content="Faw Trucks в Узбекистане" />
    <meta name="keywords" content="Faw Trucks в Узбекистане" />
    <meta name="author" content="mix_design" />

    <!-- Viewport Meta-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

    <!-- Template Favicon & Icons Start -->
    <link rel="shortcut icon" href="{% static 'images/icon/favicon_5.ico' %}" type="image/x-icon" />
    <link rel="apple-touch-icon" href="{% static 'images/icon/_iiiiapple.png' %}" />
    <link rel="apple-touch-icon" sizes="76x76" href="{% static 'images/icon/_iiii176.png' %}" />
    <link rel="apple-touch-icon" sizes="152x152" href="{% static 'images/icon/_iiii1156.png' %}" />
    <link rel="apple-touch-startup-image" href="{% static 'images/icon/_iiii1.png' %}" />
    <!-- Template Favicon & Icons End -->

    <!-- Facebook Metadata Start -->
    <meta property="og:image:height" content="1200" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:title" content="Faw Trucks в Узбекистане" />
    <meta property="og:description" content="Faw Trucks в Узбекистане" />
    <meta property="og:url" content="https://mixdesign.dev/themeforest/rayo" />
    <meta property="og:image" content="https://mixdesign.dev/themeforest/rayo/img/og-image.jpg" />
    <!-- Facebook Metadata End -->

    <!-- Template Styles Start -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/loaders/loader.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/plugins.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/main_site.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/site_main.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/breadcrumbs.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'css/site_contact.css' %}" />

    <!-- Template Styles End -->

    <!-- Custom Browser Color Start -->
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="#FAF7F6" />
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#161616" />
    <meta name="msapplication-navbutton-color" content="#161616" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <!-- Custom Browser Color End -->
</head>

<body>
    <!-- Loader Start -->
    <div id="loader" style="display: none" class="loader">
        <div class="loader__wrapper">
            <div class="loader__content">
                <div class="loader__count">
                    <span class="count__text">0</span>
                </div>
            </div>
        </div>
    </div>
    <!-- Loader End -->

    <!-- Меню и шапка (начало) -->
    {% include 'main/includes/header.html' %}
    <!-- Меню и шапка (конец) -->

    <div class="mxd-block loading-wrap">
    </div>
    <!-- Хлебные крошки -->
    <div class="mxd-section-filter pre-grid">
        <div class="mxd-section-filter__inner animate-card-3">
            <div class="mxd-grid-item-1">
                <div class="section-filter">
                    <div aria-label="breadcrumb">
                        <ol class="breadcrumb-ol">
                            <li><a href="{% url 'home' %}">Bosh sahifa</a></li>
                            <li class="active">
                                <a href="{% url 'about' %}">Kontaktlar </a>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Section - Text Block Start -->
    <div class="mxd-section padding-default">
        <div class="mxd-container grid-container">
            <!-- Block - Text Block with H2 Title, Paragraph and Contact Lists Start -->
            <div class="mxd-block">
                <div class="container-fluid px-0">
                    <div class="col contact-col">
                        <div class="col-12 col-xl-5 mxd-grid-item no-margin">
                            <div class="mxd-block__name">
                                <div class="faw-history-title fade-in">
                                    <h2>Bizning ofisimizga xush kelibsiz
                                    </h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-xl-6 mxd-grid-item no-margin">
                            <div class="mxd-block__content">
                                <div class="mxd-block__paragraph">

                                    <div class="mxd-paragraph__lists">
                                        <div class="container-fluid p-0">
                                            <div class="row g-0 contact-info__container">
                                                <div
                                                    class="col-12 col-md-6 col-xl-5 mxd-paragraph__lists-item card_border">
                                                    <div class="mxd-paragraph__lists-title">
                                                        <p
                                                            class="t-large t-bright t-caption anim-uni-in-up contact-fluid__txt">
                                                            Toshkent
                                                        </p>
                                                    </div>
                                                    <div class="contact-info__details">
                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-phone"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Telefon</h4>
                                                                <a href="tel:+998712345678"
                                                                    class="contact-detail__value">+998 71
                                                                    234-56-78</a>
                                                            </div>
                                                        </div>

                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-envelope"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Email</h4>
                                                                <a href="mailto:info@fawtrucks.uz"
                                                                    class="contact-detail__value">info@fawtrucks.uz</a>
                                                            </div>
                                                        </div>

                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-map-pin"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Manzil</h4>
                                                                <p class="contact-detail__value">Toshkent shahar,
                                                                    Yunusobod tumani</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="col-12 col-md-6 col-xl-5 mxd-paragraph__lists-item  card_border">
                                                    <div class="mxd-paragraph__lists-title">
                                                        <p
                                                            class="t-large t-bright t-caption anim-uni-in-up contact-fluid__txt">
                                                            Andijon
                                                        </p>
                                                    </div>
                                                    <div class="contact-info__details">
                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-phone"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Telefon</h4>
                                                                <a href="tel:+998712345678"
                                                                    class="contact-detail__value">+998 71
                                                                    234-56-78</a>
                                                            </div>
                                                        </div>

                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-envelope"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Email</h4>
                                                                <a href="mailto:info@fawtrucks.uz"
                                                                    class="contact-detail__value">info@fawtrucks.uz</a>
                                                            </div>
                                                        </div>

                                                        <div class="contact-detail anim-uni-in-up">
                                                            <div class="contact-detail__icon">
                                                                <i class="ph-fill ph-map-pin"></i>
                                                            </div>
                                                            <div class="contact-detail__content">
                                                                <h4 class="contact-detail__title">Manzil</h4>
                                                                <p class="contact-detail__value">Toshkent shahar,
                                                                    Yunusobod tumani</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Block - Text Block with H2 Title, Paragraph and Contact Lists End -->
        </div>
    </div>
    <!-- Section - Text Block End -->
    <div class="faw-history-title fade-in">
        <h3>Biz bilan boglaning
        </h3>
    </div>
    <!-- Page Content Start -->
    <main id="mxd-page-content" class="mxd-page-content inner-page-content">
        <!-- Section - Inner Page Headline Start -->
        <div class="mxd-section mxd-section-inner-headline padding-s-text-pre-form overflow-hidden">
            <div class="mxd-container grid-container">

            </div>
        </div>
        <!-- Section - Inner Page Headline End -->

        <!-- Section - Inner Page Form Start -->
        <div class="mxd-section mxd-section-inner-form padding-default">
            <div class="mxd-container grid-container">
                <!-- Block - Inner Page Headline Start -->
                <div class="mxd-block">
                    <div class="container-fluid px-0">
                        <div class="row gx-0">
                            <!-- Inner Headline Name Start -->
                            <div class="col-12 col-xl-2 mxd-grid-item no-margin"></div>
                            <!-- Inner Headline Name Start -->

                            <!-- Inner Headline Content Start -->
                            <div class="col-12 col-xl-8">
                                <div class="mxd-block__content contact">
                                    <div class="mxd-block__inner-form loading__fade">
                                        <div class="form-container">
                                            
                                            <!-- Сообщение о статусе (встроенное уведомление) -->
                                            <div class="form-status hidden">
                                                <p class="form-status__text"></p>
                                            </div>

                                            <!-- Contact Form Start -->
                                            <form class="form contact-form" id="contactForm">
                                                {% csrf_token %}
                                                
                                                <div class="container-fluid p-0">
                                                    <div class="row gx-0">
                                                        <div class="col-12 mxd-grid-item anim-uni-in-up contact-grid-item">
                                                            <input type="text" name="name" placeholder="F.I.Sh*" required />
                                                        </div>
                                                        <div class="col-12 mxd-grid-item anim-uni-in-up contact-grid-item">
                                                            <select name="region" required>
                                                                <option value="" disabled selected>Viloyatni tanlang*</option>
                                                                <option value="Toshkent shahri">Toshkent shahri</option>
                                                                <option value="Andijon viloyati">Andijon viloyati</option>
                                                                <option value="Buxoro viloyati">Buxoro viloyati</option>
                                                                <option value="Fargʻona viloyati">Fargʻona viloyati</option>
                                                                <option value="Jizzax viloyati">Jizzax viloyati</option>
                                                                <option value="Xorazm viloyati">Xorazm viloyati</option>
                                                                <option value="Namangan viloyati">Namangan viloyati</option>
                                                                <option value="Navoiy viloyati">Navoiy viloyati</option>
                                                                <option value="Qashqadaryo viloyati">Qashqadaryo viloyati</option>
                                                                <option value="Samarqand viloyati">Samarqand viloyati</option>
                                                                <option value="Sirdaryo viloyati">Sirdaryo viloyati</option>
                                                                <option value="Surxondaryo viloyati">Surxondaryo viloyati</option>
                                                                <option value="Toshkent viloyati">Toshkent viloyati</option>
                                                                <option value="Qoraqalpogʻiston Respublikasi">Qoraqalpogʻiston Respublikasi</option>
                                                            </select>
                                                        </div>
                                                        <div class="col-12 mxd-grid-item anim-uni-in-up contact-grid-item">
                                                            <input type="tel" name="phone" placeholder="+998 (__) ___-__-__" id="phoneInput" pattern="[+]*[0-9\s\-\(\)]*" data-default="+998" required />
                                                        </div>
                                                        <div class="col-12 mxd-grid-item anim-uni-in-up contact-grid-item">
                                                            <textarea name="message" placeholder="Qanday yuk mashinasiga qiziqasiz? Qo'shimcha savollar*" required></textarea>
                                                        </div>
                                                        <div class="col-12 mxd-grid-item anim-uni-in-up">
                                                            <button class="btn btn-anim btn-default btn-large btn-opposite slide-right-up shimmer-btn" type="submit">
                                                                <span class="btn-caption">Qongʻiroq kutaman</span>
                                                                <span class="shimmer"></span>
                                                                <i class="ph-bold ph-arrow-up-right"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </form>
                                            <!-- Contact Form End -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Inner Headline Content End -->
                        </div>
                    </div>
                </div>
                <!-- Block - Inner Page Headline End -->
            </div>
        </div>
        <!-- Section - Inner Page Form End -->




        <!-- Секция — CTA (начало) -->
        <div class="mxd-section overflow-hidden">
            <div class="mxd-container">

                <!-- Блок — CTA (начало) -->
                <div class="mxd-block">
                    <div class="mxd-promo">
                        <div class="mxd-promo__inner anim-zoom-out-container">
                            <!-- background -->
                            <div class="mxd-promo__bg"></div>
                            <!-- caption -->
                            <div class="mxd-promo__content">
                                <div class="mxd-promo__layout">
                                    <div class="mxd-promo__icon-section">
                                        <span class="mxd-promo__icon">
                                            <img src="{% static 'images/faw-logo.svg' %}" alt="FAW Icon">
                                            <span class="mxd-promo__icon-tx reveal-type">FAW TRUCKS</span>
                                        </span>
                                    </div>
                                    <div class="mxd-promo__text-section">
                                        <span class="mxd-promo__caption reveal-type">
                                            FAW bu – ishonchli texnika. Har qanday iqlimda, har qanday yo'lda FAW o'zini
                                            ko'rsatadi.
                                            Buning ortida esa o'z ishini sidqidildan bajarayotgan kuchli va jips
                                            jamoamiz turibdi.
                                            Har bir mijoz biz uchun muhim, har bir yuk – mas'uliyat.
                                            FAW jamoasi – bu tajriba, halollik va xizmatga sadoqat!
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Блок — CTA (конец) -->

            </div>
        </div>
        <!-- Секция — CTA (конец) -->

    </main>
    <!-- Page Content End -->

    <!-- Футер (начало) -->
    {% include 'main/includes/footer.html' %}
    <!-- Футер (конец) -->
    <!-- To Top Button Start -->
    <a href="#0" id="to-top" class="btn btn-to-top slide-up anim-no-delay">
        <i class="ph ph-arrow-up"></i>
    </a>
    <!-- To Top Button End -->

    <!-- Load Scripts Start -->
    <script src="{% static 'js/libs.min.js' %}"></script>
    <script src="{% static 'js/app.js' %}"></script>
    <script src="{% static 'js/faw.js' %}"></script>
    <script>
        let isSubmitting = false;

        document.addEventListener("DOMContentLoaded", () => {
            const form = document.getElementById("contactForm");
            const phoneInput = document.getElementById("phoneInput");
            const statusBlock = document.querySelector(".form-status");
            const statusText = statusBlock.querySelector(".form-status__text");

            // === Маска телефона ===
            phoneInput.addEventListener("input", (e) => {
                let value = e.target.value.replace(/\D/g, ""); // убираем все нецифры
                if (!value.startsWith("998")) value = "998" + value; // авто добавляем код страны
                if (value.length > 12) value = value.slice(0, 12);

                // форматируем +998 (__) ___-__-__
                let formatted = "+998 ";
                if (value.length > 3) formatted += "(" + value.slice(3, 5);
                if (value.length >= 5) formatted += ") " + value.slice(5, 8);
                if (value.length >= 8) formatted += "-" + value.slice(8, 10);
                if (value.length >= 10) formatted += "-" + value.slice(10, 12);

                e.target.value = formatted;
            });

            // === Отправка формы ===
            form.addEventListener("submit", async (e) => {
                e.preventDefault();
                if (isSubmitting) return;
                isSubmitting = true;

                const phone = phoneInput.value.replace(/\D/g, "");
                if (phone.length !== 12) {
                    showStatus("❌ Iltimos, telefon raqamingizni to'liq kiriting.", "error");
                    isSubmitting = false;
                    return;
                }

                const formData = {
                    name: form.name.value,
                    region: form.region.value,
                    phone: phoneInput.value,
                    message: form.message.value,
                };

                try {
                    const response = await fetch("/api/uz/contact/", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json",
                            "X-CSRFToken": form.querySelector("[name=csrfmiddlewaretoken]").value,
                        },
                        body: JSON.stringify(formData),
                    });

                    const data = await response.json();

                    if (response.ok) {
                        showStatus("✅ Xabar yuborildi! Tez orada siz bilan bog'lanamiz.", "success");
                        form.reset();
                    } else {
                        throw new Error(data.message || "Xatolik yuz berdi.");
                    }
                } catch (error) {
                    showStatus("❌ Xatolik yuz berdi. Qayta urinib ko'ring.", "error");
                } finally {
                    isSubmitting = false;
                }
            });

            // === Функция показа статуса ===
            function showStatus(message, type = "success") {
                statusText.textContent = message;
                statusBlock.className = `form-status ${type} show`;
                statusBlock.classList.remove("hidden");

                setTimeout(() => {
                    statusBlock.classList.remove("show");
                    setTimeout(() => statusBlock.classList.add("hidden"), 400);
                }, 4000);
            }

            // === Функция для получения CSRF токена из cookie ===
            function getCookie(name) {
                let cookieValue = null;
                if (document.cookie && document.cookie !== '') {
                    const cookies = document.cookie.split(';');
                    for (let i = 0; i < cookies.length; i++) {
                        const cookie = cookies[i].trim();
                        if (cookie.substring(0, name.length + 1) === (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }
        });
    </script>
</body>

</html>